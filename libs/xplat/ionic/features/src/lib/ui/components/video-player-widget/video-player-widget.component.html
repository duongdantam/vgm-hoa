<ion-content
  class="video-wrapper"
  id="video-widget"
  [ngStyle]="{ display: isHidden ? 'none' : '' }"
  [ngClass]="
    widgetLocation === 1
      ? 'widget-minimize'
      : widgetLocation === 2
      ? 'widget-minimize widget-hidden'
      : ''
  "
>
  <ion-grid>
    <ion-row>
      <ion-col size-lg="8" size="12" class="video-player">
        <div
          class="player"
          (touchstart)="onTouchStart($event)"
          (touchmove)="onTouchMove($event)"
          (touchend)="onTouchEnd($event)"
          (doubletap)="onDoubleTap($event)"
        >
          <ion-button
            fill="clear"
            class="toggle-minimize"
            (click)="toggleMinimized()"
          >
            <ion-icon
              color="light"
              [name]="
                playerService.videoWidgetLocation === 0
                  ? 'chevron-down-outline'
                  : 'chevron-up-outline'
              "
            ></ion-icon>
          </ion-button>
          <video
            #video
            id="video-player"
            class="video-js vjs-16-9 vjs-default-button"
            playsinline
            muted="{{ isMuted }}"
            autoplay
            controls
            preload="none"
            data-setup="{}"
            crossorigin="anonymous"
            (click)="controlBarTap()"
          ></video>
          <div id="minimized-control-bar">
            <marquee
              direction=""
              scrollamount="4"
              class="video-title"
              (click)="controlBarTap()"
            >
              {{ videoName }}
            </marquee>
            <button
              id="previous-btn"
              style="display: none"
              (click)="handleBackNForth(-1)"
            ></button>
            <button
              id="next-btn"
              style="display: none"
              (click)="handleBackNForth(1)"
            ></button>
            <button
              id="forward10s-btn"
              style="display: none"
              (click)="handleRewindForward(10)"
            ></button>
            <button
              id="rewind10s-btn"
              style="display: none"
              (click)="handleRewindForward(-10)"
            ></button>
            <ion-button
              expand="block"
              fill="clear"
              (click)="handleTogglePlayPause()"
              style="--padding-start: 0; --padding-end: 0; height: 50px"
            >
              <ion-icon
                slot="icon-only"
                name="{{
                  isPlaying ? 'pause-circle-outline' : 'play-circle-outline'
                }}"
              ></ion-icon>
              <ion-ripple-effect></ion-ripple-effect>
            </ion-button>
            <ion-button
              expand="block"
              fill="clear"
              (click)="collapsePlayer()"
              style="height: 50px"
            >
              <ion-icon slot="icon-only" name="close-outline"></ion-icon>
              <ion-ripple-effect></ion-ripple-effect>
            </ion-button>
          </div>
        </div>

        <ion-row class="video-info" id="video-info">
          <ion-row style="width: 100%">
            <ion-label style="font-weight: bold; padding-top: 20px">
              {{ videoName }}
            </ion-label>
          </ion-row>

          <ion-row style="width: 100%">
            <ion-label style="color: rgba(var(--ion-color-dark-rgb), 0.6)"
              >{{ 'msg.time' | translate }}: {{ videoDuration }}
            </ion-label>
          </ion-row>

          <!-- <ion-row>
            <ion-item style="overflow: inherit">
              <div class="quality-download-selector" *ngIf="downloadBtn">
                <ion-button
                  *ngFor="let quality of ['1080p', '720p', '480p']"
                  (click)="onDownload(playingItem, quality)"
                  >{{ quality }}</ion-button
                >
              </div>
              <ion-button
                expand="block"
                fill="clear"
                (click)="addToFavorite(playingItem)"
              >
                <ion-icon
                  slot="icon-only"
                  name="{{ isFavorite ? 'heart' : 'fy-heart' }}"
                ></ion-icon>
              </ion-button>
            </ion-item>
          </ion-row> -->

          <ion-row style="width: 100%">
            <!-- <ion-col size="3" class="fnBtn">
              <ion-button
                expand="block"
                fill="clear"
                size="small"
                (click)="addToFavorite(playingItem)"
              >
                <ion-icon slot="icon-only" name="fy-description"> </ion-icon>
              </ion-button>
              <ion-label>{{
                'msg.favorite.description' | translate
              }}</ion-label>
            </ion-col> -->
            <ion-col size="4" class="fnBtn">
              <ion-button
                expand="block"
                fill="clear"
                strong
                size="small"
                (click)="onShare(playingItem)"
              >
                <ion-icon slot="icon-only" name="fy-share-outline"> </ion-icon>
              </ion-button>

              <ion-label>{{ 'msg.favorite.share' | translate }}</ion-label>
            </ion-col>
            <ion-col size="4" class="fnBtn">
              <ion-button
                expand="block"
                fill="clear"
                size="small"
                (click)="addToFavorite(playingItem)"
              >
                <ion-icon
                  slot="icon-only"
                  name="{{
                    isFavorite ? 'fy-heart-solid' : 'fy-heart-outline'
                  }}"
                >
                </ion-icon>
              </ion-button>
              <ion-label>{{ 'msg.favorite.add' | translate }}</ion-label>
            </ion-col>
            <ion-col size="4" class="fnBtn">
              <ion-button
                expand="block"
                size="small"
                fill="clear"
                strong
                (click)="onDownloadSelector(playingItem, 'focus')"
                (ionBlur)="onDownloadSelector(playingItem, 'blur')"
              >
                <div class="download-progress" *ngIf="isDownloading"></div>
                <ion-icon
                  slot="icon-only"
                  name="{{
                    isDownloaded ? 'fy-download-solid' : 'fy-download-outline'
                  }}"
                >
                </ion-icon>
              </ion-button>
              <ion-label>
                {{
                  !isDownloaded
                    ? isDownloading && downloadProgress !== (0 || 100)
                      ? (downloadProgress | number: '2.0-0') + ' %'
                      : ('msg.favorite.download' | translate)
                    : ('msg.favorite.downloaded' | translate)
                }}</ion-label
              >
              <div class="quality-download-selector" *ngIf="downloadBtn">
                <ion-button
                  *ngFor="let quality of ['1080p', '720p', '480p']"
                  (click)="onDownload(playingItem, quality)"
                  >{{ quality }}</ion-button
                >
              </div>
            </ion-col>
          </ion-row>
        </ion-row>
      </ion-col>

      <ion-col
        size-lg="4"
        size="12"
        *ngIf="itemList"
        class="video-list"
        id="video-list"
      >
        <ion-row>
          <ion-label
            style="
              font-weight: bold;
              font-size: medium;
              color: var(--ion-color-primary);
            "
            >{{ getListTitle() }}
          </ion-label>
        </ion-row>

        <ion-list>
          <ion-item
            *ngFor="let item of itemList | slice: 0:itemLength"
            (click)="selectItem(item)"
            (mouseover)="preloadData(item)"
            [ngClass]="item.id === videoId ? 'selected-item' : ''"
          >
            <ion-thumbnail #thumbnail slot="start">
              <div class="thumbnail-loading">
                <ion-skeleton-text
                  [animated]="false"
                  style="height: calc(100% - 2px)"
                ></ion-skeleton-text>
              </div>
              <ion-img
                [src]="
                  item.thumb !== ''
                    ? item.thumb
                    : 'assets/imgs/default-image.svg'
                "
                (ionError)="item.thumb = 'assets/imgs/default-image.svg'"
                (ionImgDidLoad)="imgOnLoad('loaded', thumbnail, item)"
              ></ion-img>
            </ion-thumbnail>
            <div style="flex-direction: column">
              <div style="font-size: small; font-weight: bold">
                {{ item.value }}
              </div>
              <div
                style="
                  font-size: small;
                  color: var(--ion-color-dark-tint);
                  padding: 5px 0 5px 0;
                "
              >
                {{ item.duration }}
              </div>
            </div>
          </ion-item>

          <ion-infinite-scroll
            threshold="100px"
            (ionInfinite)="loadMoreData($event)"
          >
            <ion-infinite-scroll-content loadingSpinner="bubbles">
            </ion-infinite-scroll-content>
          </ion-infinite-scroll>
        </ion-list>
      </ion-col>

      <ion-col size-lg="4" size="12" class="loading" *ngIf="!itemList">
        <ion-spinner name="dots"></ion-spinner>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
